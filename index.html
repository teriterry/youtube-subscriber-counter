<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>YouTube チャンネル登録者数</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="./css/rolling-counter.css" />
    <link rel="stylesheet" href="./style.css" />

</head>

<body>
    <button id="loginBtn">Google にログインして登録者数を表示</button>

    <div class="target-settings">
        <div class="target-item">
            <label for="myNumber">目標登録者数</label>
            <input type="number" id="myNumber" min="0" step="1" value="0">
        </div>
        <div class="target-item">
            <label for="toggleTarget">目標設定機能 ON/OFF</label>
            <input type="checkbox" id="toggleTarget" />
        </div>
        <button class="btnTarget">
            目標設定OK
        </button>
    </div>

    <!-- <div id="subscriberCount">読み込み中...</div> -->
    <div class="stats-container">
        <div class="target-container">
            <span>目標</span>
            <span id="targetDisplay">400000</span>
        </div>

        <div class="counter" id="subscriberCount"></div>

        <div class="div1"></div>
        <div class="div2"></div>
        <div class="div3"></div>
        <div class="div4"></div>
        <div class="div5"></div>
        <div class="div6"></div>
        <div class="div7"></div>
        <div class="div8"></div>
        <div class="div9"></div>
        <div class="div10"></div>

        <div class="div11"></div>
        <div class="div12"></div>
        <div class="div13"></div>
        <div class="div14"></div>

        <div class="div15"></div>
        <div class="div16"></div>
        <div class="div17"></div>
        <div class="div18"></div>

        <div class="div19"></div>
        <div class="div20"></div>

    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script type="module" src="./script.js"></script>

    <script>
        let fakeCount = 399990;
        let targetCount = 400000;
        let enableTargetCheck = false;
        let btnClick = false;

        $('.target-container').hide();
        $('.div2').hide();
        $('.div15').hide();
        $('.div16').hide();
        $('.div19').hide();

        $(function () {
            $('#toggleTarget').on('change', function () {
                if ($(this).is(':checked')) {
                    enableTargetCheck = true;

                    $('.target-container').fadeIn(300);
                } else {
                    enableTargetCheck = false;

                    $('.target-container').fadeOut(300);
                    $('.div2').hide();
                    $('.div11').css({
                        'background-image': 'url("./img/img2/body1.png")',
                        'animation': '2s headShake linear infinite'
                    });
                    $('.div12').show();
                    $('.div15').hide();
                    $('.div16').hide();
                    $('.div19').hide();
                }
            });

            $('.btnTarget').on('click', function () {
                const userInput = parseInt($('#myNumber').val(), 10);
                if (!isNaN(userInput) && userInput > 0) {
                    targetCount = userInput;
                    $('#targetDisplay').text(targetCount);
                }
                btnClick = true;
            });

            setInterval(function () {
                fakeCount += 1;

                if (window.subsCounter && typeof window.subsCounter.update === 'function') {
                    window.subsCounter.update(fakeCount.toString());

                    if (fakeCount >= targetCount && enableTargetCheck && btnClick) {
                        // $('.target-container').fadeIn(300);
                        $('.div2').fadeIn(300);
                        $('.div11').css({
                            'background-image': 'url("./img/img2/body2.png")',
                            'animation': '2s bounce ease-in-out infinite'
                        });
                        $('.div12').hide();
                        $('.div15').show();
                        $('.div16').show();
                        $('.div19').show();
                    } else {
                        // $('.target-container').fadeOut(300);
                        $('.div2').fadeOut(300);
                        $('.div11').css({
                            'background-image': 'url("./img/img2/body1.png")',
                            'animation': '2s headShake linear infinite'
                        });
                        $('.div12').show();
                        $('.div15').hide();
                        $('.div16').hide();
                        $('.div19').hide();
                    }
                }
            }, 1000);
        });
    </script>



</body>

</html>